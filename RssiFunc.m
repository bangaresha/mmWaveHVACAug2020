function reflecjRssi = RssiFunc(t,Tx,FPSLRefLoss,first2SecondPointjDist1,first2SecondPointjDist2,tempFirst2SecPointTransCoeff1,tempFirst2SecPointTransCoeff2,tempFirst2SecPointTransCoeff3,tempReflecCoeff1,tempReflecCoeff2,depBeamAngle,arrBeamAngle,lightVel,Rx2TxRefl,freq,TxAntennaGainAE,RxAntennaGainAE)
p = 1013.25;
T = 306;
rho = 1300;
rp = p/1013;
rt = 288/T;
% gammaY = 1;
gammaY = ((rt*3.27E-2) + (1.67E-3 * (rho*(rt^7)/rp)) + (7.7E-4 * sqrt(freq)) +...
    (3.79/(((freq - 22.235)^2) + 9.81*rt*rp*rp)) + ((11.71*rt)/(((freq - 183.31)^2) + 11.85*rt*rp*rp)) + ...
    ((4.01*rt)/(((freq - 325.153)^2) + 10.44*rt*rp*rp))) * freq*freq*rho*rp*rt*1E-4;
gammaD = 14.94*(rp^2)*(rt^8.5);

if depBeamAngle.AziIndex == 0
    reflecjRssi = 10^((Tx.power(1,:) - (FPSLRefLoss + 20*log10(4*pi*(first2SecondPointjDist1 + first2SecondPointjDist2) .* ...
                freq ./ lightVel)) + (10*log10(prod(tempFirst2SecPointTransCoeff1)))+ ...
                (10*log10(prod(tempFirst2SecPointTransCoeff2))) + (10*log10(prod(tempFirst2SecPointTransCoeff3))) +...
                (10*log10(tempReflecCoeff1))+ (10*log10(tempReflecCoeff2))+ 10*log10(1/(4060*1000)) + ...
                - 10*log10(gammaD) - 10*log10(gammaY) + (t*10*log10(1/first2SecondPointjDist1))+ ...
                (t*10*log10(1/first2SecondPointjDist2)))/10).* complex(cos(2*pi*freq* Rx2TxRefl./lightVel + pi),...
                sin(2*pi*freq*Rx2TxRefl./lightVel + pi));
else
    reflecjRssi = 10^((Tx.power(1,:) - (FPSLRefLoss + 20*log10(4*pi*(first2SecondPointjDist1 + first2SecondPointjDist2) .* ...
                freq ./ lightVel)) + (10*log10(prod(tempFirst2SecPointTransCoeff1)))+...
                (10*log10(prod(tempFirst2SecPointTransCoeff2))) + (10*log10(prod(tempFirst2SecPointTransCoeff3))) +...
                (10*log10(tempReflecCoeff1))+ (10*log10(tempReflecCoeff2)) + 10*log10(1/(4060*1000)) ...
                - 10*log10(gammaD) - 10*log10(gammaY) + (TxAntennaGainAE(round(depBeamAngle.AziIndex),round(depBeamAngle.ZenIndex))) + ... 
                (RxAntennaGainAE(round(arrBeamAngle.AziIndex),round(arrBeamAngle.ZenIndex))) + ...
                (t*10*log10(1/first2SecondPointjDist1)) + (t*10*log10(1/first2SecondPointjDist2)))/10) ...
                .* complex(cos(2*pi*freq* Rx2TxRefl./lightVel + pi) ,...
                sin(2*pi*freq*Rx2TxRefl./lightVel + pi));
end
end